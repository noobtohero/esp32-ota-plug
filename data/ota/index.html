<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="ESP32 OTA Firmware Update Panel">
<title>ESP32 OTA Admin</title>
<link rel="stylesheet" href="/ota/style.css">
</head>
<body>

<!-- Login Screen -->
<div id="login" class="login-box">
  <h2>ğŸ” Admin Login</h2>
  <form id="login-form" onsubmit="handleLogin(event)">
    <label for="user">Username</label>
    <input 
      id="user" 
      type="text" 
      placeholder="Username" 
      autocomplete="username" 
      aria-label="Username"
      required
    >
    
    <label for="pass">Password</label>
    <input 
      id="pass" 
      type="password" 
      placeholder="Password" 
      autocomplete="current-password"
      aria-label="Password"
      required
    >
    
    <button type="submit" id="login-btn">Login</button>
  </form>
  
  <div id="login-msg" role="alert" aria-live="polite"></div>
  
  <p class="version-info">Current OTA Version: <b id="ota-version">-</b></p>
</div>

<!-- Main Panel -->
<div id="panel" class="container hidden">
  <h1>ESP32 OTA Panel</h1>
  <p class="subtitle">Firmware Control & Monitoring</p>

  <!-- Status Card -->
  <div class="card status">
    <span id="badge">IDLE</span>
    <p>Version: <b id="version">-</b></p>
    <p>Uptime: <b id="uptime">-</b></p>
    <div id="status-msg" class="hidden message success">âœ… Update successful! Refreshing...</div>
  </div>

  <!-- Update Card with Tabs -->
  <div class="card">
    <h2>ğŸ”„ Firmware Update</h2>
    
    <!-- Tab Buttons -->
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('manual')" id="tab-manual">
        ğŸ“¦ Manual Upload
      </button>
      <button class="tab-btn" onclick="switchTab('url')" id="tab-url">
        ğŸŒ From URL
      </button>
    </div>

    <!-- Manual Upload Tab Content -->
    <div id="content-manual" class="tab-content active">
      <label for="file">Select Firmware File (.bin)</label>
      <input 
        type="file" 
        id="file" 
        accept=".bin"
        aria-label="Firmware file"
      >
      <button onclick="handleUpload()" id="upload-btn" class="update-btn">
        <span class="btn-text">Upload Firmware</span>
        <span class="btn-progress hidden">0%</span>
      </button>
      <div id="upload-msg" role="alert" aria-live="polite"></div>
    </div>

    <!-- URL Update Tab Content -->
    <div id="content-url" class="tab-content hidden">
      <label for="url">Firmware URL</label>
      <input 
        id="url" 
        type="url"
        placeholder="https://server/firmware.bin"
        aria-label="Firmware URL"
      >
      <button onclick="handleUpdateFromURL()" id="url-btn" class="update-btn">
        <span class="btn-text">Update from URL</span>
        <span class="btn-progress hidden">0%</span>
      </button>
      <div id="url-msg" role="alert" aria-live="polite"></div>
    </div>
  </div>

  <footer>ESP32 OTA â€¢ Rollback Protected</footer>
</div>

<script src="/ota/app.js"></script>
</body>
</html>
